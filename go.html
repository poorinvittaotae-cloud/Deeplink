<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>ReadAWrite</title>
<meta name="robots" content="noindex,nofollow">
<style>
  :root{color-scheme:light dark}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#fff;color:#111}
  .wrap{min-height:100dvh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px}
  .hero{max-width:420px;width:100%;text-align:center;margin:auto}
  .logo{font-weight:800;letter-spacing:.5px;font-size:12px;color:#9ca3af;margin-bottom:8px}
  h1{font-size:40px;letter-spacing:1px;margin:0 0 8px;text-transform:uppercase}
  .sub{color:#6b7280;line-height:1.5;margin-bottom:24px}
  .phone{width:210px;height:210px;margin:8px auto 24px;display:block}
  .btns{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
  a.btn,button.btn{flex:1 1 220px;max-width:280px;border-radius:12px;border:2px solid #16a34a;
    font-weight:800;padding:14px 16px;text-align:center;text-decoration:none;cursor:pointer}
  .primary{background:#16a34a;color:#fff}
  .ghost{background:#fff;color:#16a34a}
  .hint{margin-top:18px;font-size:13px;color:#6b7280;text-align:center;max-width:520px}
  .foot{position:fixed;left:0;right:0;bottom:0;padding:8px 16px;text-align:center;color:#9ca3af;font-size:12px}
  @media (prefers-color-scheme:dark){
    body{background:#0b0b0b;color:#e5e7eb}
    .sub,.hint{color:#9ca3af}
    .ghost{background:transparent}
  }
</style>
</head>
<body>
<div class="wrap">
  <div class="hero">
    <div class="logo">readawrite.com</div>
    <h1>READAWRITE</h1>
    <div class="sub">ลองเปิดเรื่องนี้ในแอป ReadAWrite ได้ทันที ไม่ต้องคัดลอกลิงก์</div>

    <!-- ภาพประกอบแนว LINEGIFT (SVG เบา ๆ) — เปลี่ยนเป็นรูปของคุณได้ -->
    <svg class="phone" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <rect x="55" y="25" width="90" height="150" rx="16" stroke="#111827" stroke-width="4"/>
      <circle cx="100" cy="100" r="28" fill="#16a34a"/>
      <path d="M100 84v32M84 100h32" stroke="#fff" stroke-width="6" stroke-linecap="round"/>
    </svg>

    <div class="btns">
      <a id="openApp" class="btn primary" rel="noopener">เปิดในแอป</a>
      <a id="getApp"  class="btn ghost"   rel="noopener">ดาวน์โหลดแอป</a>
    </div>

    <div id="hint" class="hint"></div>
  </div>
</div>
<div class="foot">ถ้าอยู่ใน Facebook/LINE แล้วไม่เด้ง ให้ “เปิดด้วยเบราว์เซอร์หลัก” ก่อน</div>

<script>
/* ---------- CONFIG ---------- */
const SCHEME = "readawrite";
const ANDROID_PKG = "com.readawrite";
const PLAY = "https://play.google.com/store/apps/details?id=" + ANDROID_PKG;
const APPSTORE = "https://apps.apple.com/th/app/readawrite/id1033832353";

/* รับปลายทางจาก ?path=  หรือ ?url=  */
const qs = new URLSearchParams(location.search);
let PATH = (qs.get("path") || "").replace(/^\/+/, "");
const RAW_URL = qs.get("url");
const DEFAULT_PATH = "a/512604c87af04b0b7d3d02f31a2289be"; // แก้ค่าเริ่มต้นได้
if (!PATH && RAW_URL) { try { PATH = new URL(RAW_URL).pathname.replace(/^\/+/, ""); } catch {} }
if (!PATH) PATH = DEFAULT_PATH;
const WEB = "https://www.readawrite.com/" + PATH;

/* ---------- Env detect ---------- */
const ua = navigator.userAgent||"";
const isAndroid=/Android/i.test(ua);
const isIOS=/iPhone|iPad|iPod/i.test(ua);
const isFB=/\bFBAN|FBAV\b/i.test(ua);
const isLINE=/Line/i.test(ua);
const isIG=/Instagram/i.test(ua);
const isInApp=isFB||isLINE||isIG;

/* ---------- Elements ---------- */
const $ = s=>document.querySelector(s);
const openBtn = $("#openApp");
const getBtn  = $("#getApp");
const hintEl  = $("#hint");

/* เมื่อแอปเปิดจริง หน้า web จะเป็น hidden → ยกเลิก fallback */
function guard(onTimeout, ms){
  let done=false;
  const t=setTimeout(()=>{ if(!done){ done=true; cleanup(); onTimeout(); } }, ms);
  const vis=()=>{ if(document.visibilityState==="hidden" && !done){ done=true; cleanup(); } };
  function cleanup(){ clearTimeout(t); document.removeEventListener("visibilitychange", vis); }
  document.addEventListener("visibilitychange", vis);
}

/* ตั้งค่าปุ่ม “ดาวน์โหลดแอป” ตามแพลตฟอร์ม */
getBtn.href = isIOS ? APPSTORE : PLAY;

/* ตั้งค่าปุ่ม “เปิดในแอป” ให้เป็น <a> ที่ FB/LINE ยอมให้กดได้ */
if (isAndroid) {
  openBtn.href =
    `intent://${PATH}`+
    `#Intent;scheme=${SCHEME};package=${ANDROID_PKG};`+
    `S.browser_fallback_url=${encodeURIComponent(WEB)};end`;
} else if (isIOS) {
  openBtn.href = `${SCHEME}://${PATH}`;
  openBtn.addEventListener("click", ()=> { guard(()=>{ location.href = APPSTORE; }, 1000); });
} else {
  openBtn.href = WEB; // desktop
}

/* ถ้าอยู่ใน FB/LINE/IG บน Android → แนะนำให้ออกจาก in‑app ก่อน */
if (isAndroid && isInApp) {
  openBtn.addEventListener("click", (e)=>{
    // กันบางรุ่นที่บล็อก scheme/intent → พาไปเว็บก่อน
    e.preventDefault();
    try { window.open(WEB, "_blank", "noopener"); } catch(e){}
    setTimeout(()=>{ location.href = WEB; }, 120);
  });
  hintEl.textContent = "Facebook/LINE บล็อกการเปิดแอปโดยตรง ให้เปิดลิงก์ใน Chrome ก่อน แล้วค่อยกด ‘เปิดในแอป’";
} else if (isIOS && isInApp) {
  hintEl.textContent = "บน iPhone: แตะ ⋯ หรือ แชร์ แล้วเลือก ‘เปิดใน Safari’ จากนั้นกด ‘เปิดในแอป’";
} else {
  // นอก in‑app: auto‑launch เพื่อความลื่น
  hintEl.textContent = "กำลังพยายามเปิดในแอปอัตโนมัติ…";
  setTimeout(()=>{
    if (isAndroid) {
      guard(()=>{ location.href = PLAY; }, 1200);
      location.href = `${SCHEME}://${PATH}`; // auto แบบ scheme ตรง ลื่นสุดบน Chrome
    } else if (isIOS) {
      guard(()=>{ location.href = APPSTORE; }, 1000);
      const ifr=document.createElement("iframe");
      ifr.style.display="none"; ifr.src=`${SCHEME}://${PATH}`; document.body.appendChild(ifr);
    }
  }, 350);
}
</script>
</body>
</html>
